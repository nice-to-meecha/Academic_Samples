<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>WriteCSV.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">HW09</a> &gt; <a href="index.source.html" class="el_package">problem01.model</a> &gt; <span class="el_source">WriteCSV.java</span></div><h1>WriteCSV.java</h1><pre class="source lang-java linenums">package problem01.model;

import java.io.BufferedWriter;
import java.io.IOException;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.time.format.DateTimeFormatter;
import java.util.List;
import java.util.Objects;
import problem01.controller.Todo;
import problem01.view.InvalidNullArgumentException;

/**
 * Class which writes all stored To-do information within a provided
 * .csv file.
 */
public class WriteCSV implements IWriteCSV {

<span class="fc" id="L19">  private static final String[] TODO_GETTERS = new String[]{&quot;getId&quot;, &quot;getText&quot;,</span>
      &quot;getCompleted&quot;, &quot;getDueDate&quot;, &quot;getPriority&quot;, &quot;getCategory&quot;};
<span class="fc" id="L21">  private static final String[] HEADER_TITLES = new String[]{&quot;id&quot;, &quot;text&quot;,</span>
      &quot;completed&quot;, &quot;due&quot;, &quot;priority&quot;, &quot;category&quot;};
<span class="fc" id="L23">  private static final DateTimeFormatter DATE_FORMATTER =</span>
<span class="fc" id="L24">      DateTimeFormatter.ofPattern(&quot;M/d/uuuu&quot;);</span>
  private static final int TOTAL_COLUMNS = 6;
  private static final int DATE_COLUMN = 3;

  private List&lt;Todo&gt; todoList;
  private List&lt;Integer&gt; headerColumnOrder;

  /**
   * Generates a WriteCSV object, utilizing the list of Todos to be written
   * to a .csv file as well as the order of columns, in which to write the
   * information.
   *
   * @param todoList - the list of Todos to be written to a .csv file
   * @param headerColumnOrder - the order of columns, in which the To-do information
   *                          will be written
   *
   * @throws InvalidNullArgumentException - thrown when a null argument is utilized
   * in unsupported fashion.
   */
  public WriteCSV(List&lt;Todo&gt; todoList, List&lt;Integer&gt; headerColumnOrder)
<span class="fc" id="L44">      throws InvalidNullArgumentException{</span>
<span class="fc" id="L45">    CheckNullUtils.evaluate(todoList);</span>
<span class="fc" id="L46">    CheckNullUtils.evaluate(headerColumnOrder);</span>

<span class="fc" id="L48">    this.todoList = todoList;</span>
<span class="fc" id="L49">    this.headerColumnOrder = headerColumnOrder;</span>
<span class="fc" id="L50">  }</span>

  /**
   * Fills a csv with previously stored and/or altered information,
   * regarding Todos.
   *
   * @param csv - the file to which the Todos -- newly generated or altered --
   *                will be written
   *
   * @throws IOException - input/output exception, which is thrown if an error is
   * encountered while writing to newFile
   * @throws InvalidNullArgumentException - thrown when a null argument is utilized
   * in unsupported fashion.
   * @throws NoSuchMethodException - thrown if a method name utilized within getMethod()
   * is non-existent.
   * @throws InvocationTargetException - thrown if the method called by invoke() throws
   * an exception.
   * @throws IllegalAccessException - thrown if the method called by invoke() is
   * inaccessible.
   */
  @Override
  public void writeContentsToCSV(BufferedWriter csv) throws IOException,
      InvalidNullArgumentException, NoSuchMethodException, InvocationTargetException,
      IllegalAccessException {
<span class="fc" id="L74">    CheckNullUtils.evaluate(csv);</span>

<span class="fc" id="L76">    this.writeHeaderToCSV(csv);</span>

<span class="fc" id="L78">    int i, startCount = 0, avoidCommaAtEnd = 1;</span>
<span class="fc bfc" id="L79" title="All 2 branches covered.">    for (Todo todo: this.todoList) {</span>
<span class="fc" id="L80">      i = startCount;</span>
<span class="fc" id="L81">      StringBuilder row = new StringBuilder();</span>
<span class="fc bfc" id="L82" title="All 2 branches covered.">      for (Integer columnIndex : this.headerColumnOrder) {</span>
<span class="fc" id="L83">        String entry = this.checkEntry(todo, columnIndex);</span>
<span class="fc" id="L84">        row.append(&quot;\&quot;&quot;).append(entry).append(&quot;\&quot;&quot;);</span>
<span class="fc bfc" id="L85" title="All 2 branches covered.">        if (i &lt; TOTAL_COLUMNS - avoidCommaAtEnd) {</span>
<span class="fc" id="L86">          row.append(&quot;,&quot;);</span>
        }
<span class="fc" id="L88">        i++;</span>
<span class="fc" id="L89">      }</span>
<span class="fc" id="L90">      csv.write(row + &quot;\n&quot;);</span>
<span class="fc" id="L91">    }</span>
<span class="fc" id="L92">  }</span>

  /**
   * Provides the appropriate String representation of a To-do field, in order to
   * write it to a csv file. If unknown (null), the field is stored as a question
   * mark (?).
   *
   * @param todo - the Todo object whose field is to be assessed for storage purposes
   * @param columnIndex - the specific column with which this information is associated
   *
   * @return appropriate String representation of a To-do field, specifically for storage
   * within a csv file.
   *
   * @throws NoSuchMethodException - thrown if a method name utilized within getMethod()
   * is non-existent.
   * @throws InvocationTargetException - thrown if the method called by invoke() throws
   * an exception.
   * @throws IllegalAccessException - thrown if the method called by invoke() is
   * inaccessible.
   */
  private String checkEntry(Todo todo, Integer columnIndex) throws NoSuchMethodException,
      InvocationTargetException, IllegalAccessException{
    String entry;
<span class="fc" id="L115">    Method method = Todo.class.getMethod(TODO_GETTERS[columnIndex]);</span>
<span class="fc bfc" id="L116" title="All 4 branches covered.">    if (columnIndex == DATE_COLUMN &amp;&amp; method.invoke(todo) != null) {</span>
<span class="fc" id="L117">      entry = todo.getDueDate().format(DATE_FORMATTER);</span>
    }
    else {
<span class="fc bfc" id="L120" title="All 2 branches covered.">      entry = method.invoke(todo) == null ? &quot;?&quot; : method.invoke(todo).toString();</span>
    }
<span class="fc" id="L122">    return entry;</span>
  }

  /**
   * Writes the row containing header information to the provided .csv file
   *
   * @param csv - the file to which the Todos -- newly generated or altered --
   *                will be written
   *
   * @throws IOException - input/output exception, which is thrown if an error is
   * encountered while writing to newFile
   */
  private void writeHeaderToCSV(BufferedWriter csv) throws IOException {
<span class="fc" id="L135">    int i = 0, avoidCommaAtEnd = 1;</span>
<span class="fc" id="L136">    StringBuilder row = new StringBuilder();</span>
<span class="fc bfc" id="L137" title="All 2 branches covered.">    for (Integer columnIndex: this.headerColumnOrder) {</span>
<span class="fc" id="L138">      row.append(&quot;\&quot;&quot;).append(HEADER_TITLES[columnIndex]).append(&quot;\&quot;&quot;);</span>
<span class="fc bfc" id="L139" title="All 2 branches covered.">      if (i &lt; TOTAL_COLUMNS - avoidCommaAtEnd) {</span>
<span class="fc" id="L140">        row.append(&quot;,&quot;);</span>
      }
<span class="fc" id="L142">      i++;</span>
<span class="fc" id="L143">    }</span>
<span class="fc" id="L144">    csv.write(row + &quot;\n&quot;);</span>
<span class="fc" id="L145">  }</span>

  /**
   * Determines whether a WriteCSV object is equivalent to another object,
   * comparing memory location, class, and field values.
   *
   * @param o - the object being compared with a WriteCSV object
   *
   * @return boolean indicating whether a WriteCSV object is equivalent
   * to another object
   */
  @Override
  public boolean equals(Object o) {
<span class="fc bfc" id="L158" title="All 2 branches covered.">    if (this == o) {</span>
<span class="fc" id="L159">      return true;</span>
    }
<span class="fc bfc" id="L161" title="All 4 branches covered.">    if (o == null || this.getClass() != o.getClass()) {</span>
<span class="fc" id="L162">      return false;</span>
    }
<span class="fc" id="L164">    WriteCSV writeCSV = (WriteCSV) o;</span>
<span class="fc bfc" id="L165" title="All 2 branches covered.">    return Objects.equals(this.todoList, writeCSV.todoList) &amp;&amp;</span>
<span class="fc bfc" id="L166" title="All 2 branches covered.">        Objects.equals(this.headerColumnOrder, writeCSV.headerColumnOrder);</span>
  }

  /**
   * Determines the hashcode of a WriteCSV object
   *
   * @return the hashcode of a WriteCSV object
   */
  @Override
  public int hashCode() {
<span class="fc" id="L176">    return Objects.hash(this.todoList, this.headerColumnOrder);</span>
  }

  /**
   * Provides a string representation of a WriteCSV object
   *
   * @return a string representation of a WriteCSV object
   */
  @Override
  public String toString() {
<span class="fc" id="L186">    return &quot;WriteCSV {&quot; +</span>
        &quot;todoList = &quot; + this.todoList +
        &quot;, headerColumnOrder = &quot; + this.headerColumnOrder +
        '}';
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.4.201905082037</span></div></body></html>